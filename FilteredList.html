<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- <link rel="stylesheet" type="text/css" href="main.css"> -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.9/angular.min.js"></script>
	<title>Admin - Form Clusters</title>
	<!-- Page can be loaded as: /FilteredList.html?z=19871&h=BayAreaHospitalAssociation -->
	<style type="text/css">
	body{background-color: #f7f7f7;}
	body>div{background-color: #fff; padding: 15px 0 15px 0;}
	/*.nav-wrapper{margin: 25px 0 50px 0;}*/
	.table td, .table th{
		padding: 0;
	}
	#login_wrapper>#use_api_wrapper,#login_wrapper.active>#log_in{display:none;}
	#login_wrapper.active>#use_api_wrapper,#login_wrapper>#log_in{display:inline;}
	.success-message{
		background-color: lightgreen;
		font-weight: bold;
	}
	.zip-buttons>button, .need-buttons>button{
		margin: 0 10px;
	}
	button.form-cluster{
		background-color: lightgreen;
		border: 1px solid green;
		border-radius: 5px;
		padding: 6px;
		font-weight: bold;
	}
	div.user-list-container{
		height: 400px;
		overflow: auto;
	}
	.list-container label{
		display: block;
		height: 100%;
	}
	</style>
	</head>
    <body>
      <div ng-app="myApp" ng-controller="myCtrl" class="shadow-sm mb-5 light rounded"> <!--OVERALL CONTAINING DIV FOR STYLISTIC PURPOSES-->
		  <div class="container p-0"> <!--CONTAINER DIV FOR HEADER AND NAV BAR-->
			  <div class="row">
				<!-- <div class="container d-flex justify-content-center">
					<img style="width: 225px; height: 225px;" src="http://alexdomzalski.com/botglogo.png">
				</div> -->
			  </div>
		  </div>
		  <div class="row">
			<div class="container d-flex justify-content-center">
				<h3>Boots on the Ground - 3 Caregivers</h3><br />
			</div>
		  </div>
          <div class="row">
			<div class="container d-flex justify-content-center">
                <h2>Admin - Form Clusters</h2>
			</div>
		  </div>
		  
          <div class="row nav-wrapper">
              <nav class="navbar navbar-light bg-light col-lg-12 justify-content-center">
                <ul class="nav nav-tabs">
                  <li class="nav-item">
                    <a class="nav-link" href="index.html">Home</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="signup.html">Sign-Up</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#!">Members</a>
                  </li>
                </ul>
              </nav>
          </div>
		  
		  <div class="container" ng-show="showPWRow">
			<span class="pw">
				<h3>Log In</h3>
				<!-- Password: <input type="password" ng-model="PW" />
				<button ng-click="fetchUserList()">Set Password</button> -->
				<span id="login_wrapper">
					<span id="log_in">
						Not logged in<br />
						Login: <a href="login.html" class="btn btn-primary">Log In Page</a>
					</span>
					<span id="use_api_wrapper">
						<button ng-click="setUseAPI(true)">Use API</button>
						- OR -
					</span>
				</span>
				<button ng-click="setUseAPI(false)">Use Local Data</button>
			</span><br />
		  </div>
		  
		  <div class="container initial-selection-container" ng-show="showInitialSelectionRow">
			<h3>How do you want to play with the data?</h3>
			<button ng-click="showMainConsole()">Type in Filters</button>
			<button ng-click="fetchDistinctZips()">Get List of Zip Codes</button>
			<button ng-click="fetchUserList()">Fetch First 50 Needers</button>
		  </div>
		  
		  <div class="container" ng-show="showMainConsoleRow">
			<span class="zip-buttons">
				<strong>Main filters:</strong><br />
				Zip code: <input ng-model="zipApiFilter" />
				Hash: <input ng-model="hashApiFilter" />
				<button name="search" ng-click="setMainFilters()">Search</button><br />
				<button ng-repeat="(key,val) in zipSummary" ng-click="setZip(key)">{{key}} - {{val.needers}} : {{val.careTakers}}</button>
				<!-- <button ng-click="fetchDistinctZips()">&gt;</button> -->
				<button ng-click="setZip()" title="Clear filter">X</button>
			</span>
			<br />
			<br />
			<span class="need-buttons">
				<strong>Need Filters:</strong><br />
				<button ng-repeat="(key,val) in needs" ng-click="setNeedFilter(val)">{{key}}</button>
				<button ng-click="setNeedFilter()" title="Clear filter">X</button>
			</span>
			<br />
			<br />
			<center>
				<button class="form-cluster" ng-click="formCluster()">Form Cluster</button>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="checkbox" ng-model="includeClustered" value="1" id="includeClustered" checked="checked" ng-init="includeClustered=true" />
				<label for="includeClustered">Include Cluster Table</label>
				<!-- Maybe default to not checked and only fetching data when checked -->
			</center>
		  </div>
		  <br />
          <div ng-show="showMainConsoleRow"> <!--CONTAINER DIV FOR MAIN FILTERLIST CONTENT-->
            <div class="row">
			  <div class="success-message" ng-bind="successMessage"></div>
			</div>
            <div class="row pl-4 pr-4">
              <div class="{{includeClustered ? 'col-md-4' : 'col-md-6'}}">
				  <h4>Needers {{neederCount}} </h4>
				  <div class="user-list-container list-container">
					  <table class="table table-hover">
						<thead>
						  <tr>
							<th></th>
							<th><a href="javascript:void(0);" ng-click="neederOrderBy('ZipCode')">Zip</a></th>
							<th><a href="javascript:void(0);" ng-click="neederOrderBy('name')">User</a></th>
							<th><a href="javascript:void(0);" ng-click="neederOrderBy('Description')">Needs</a></th>
							<th><a href="javascript:void(0);" ng-click="neederOrderBy('Hashtags')">Tags</a></th>
							<th>Delete</th>
						  </tr>
						</thead>
						<tbody>
						  <tr data-ng-repeat="d in needers | filter:{ZipCode:neederZipFilter} | orderBy: neederOrderByVar" data-uid="{{d._id}}">
							<td><input type="radio" name="select_needer" ng-click="setNeeder(this)" ng-value="d._id" id="{{d._id}}}" /></td>
							<td>
								<label for="{{d._id}}}">{{d.ZipCode}}</label>
							</td>
							<td><a href="mailto:{{d.email}}">{{d.name}}</a> ({{d.RequestedClusterSize || 3}})</td>
							<td>
								<label for="{{d._id}}}">{{d.Description}}</label>
							</td>
							<td>
								<label for="{{d._id}}}">{{d.Hashtags}}</label>
							</td>
							<td><button name="remove_user" class="btn btn-outline-danger" ng-click="removeUser(d._id, 'needers')">X</button></td>
						  </tr>
						</tbody>
					  </table>
				  </div>
			  </div>
              <div class="{{includeClustered ? 'col-md-4' : 'col-md-6'}}">
				  <h4>Care Givers {{careTakerCount}}</h4>
				  <div class="user-list-container">
					  <table class="table table-hover">
						<thead>
						  <tr>
							<th></th>
							<th><a href="javascript:void(0);" ng-click="careTakerOrderBy('ZipCode')">Zip</a></th>
							<th><a href="javascript:void(0);" ng-click="careTakerOrderBy('name')">User</a></th>
							<th><a href="javascript:void(0);" ng-click="careTakerOrderBy('Description')">Provides</a></th>
							<th><a href="javascript:void(0);" ng-click="careTakerOrderBy('Hashtags')">Tags</a></th>
						  </tr>
						</thead>
						<tbody>
						  <tr ng-repeat="d in careTakers | filter:{ZipCode:careTakerZipFilter, Description:needFilter} | orderBy: careTakerOrderByVar" data-uid="{{d._id}}">
							<td><input type="checkbox" name="select_care_taker" ng-model="d.selected" checklist-value="d._id" id="{{d._id}}" /></td>
							<td>
								<label for="{{d._id}}">{{d.ZipCode}}</label>
							</td>
							<td><a href="mailto:{{d.email}}">{{d.name}}</a> ({{d.SlotCount || 1}})</td>
							<td>
								<label for="{{d._id}}">{{d.Description}}</label>
							</td>
							<td>
								<label for="{{d._id}}">{{d.Hashtags}}</label>
							</td>
							<td><button name="remove_user" class="btn btn-outline-danger" ng-click="removeUser(d._id, 'careTakers')">X</button></td>
						  </tr>
						</tbody>
					  </table>
				  </div>
              </div>
              <div class="col-md-4" ng-show="includeClustered">
				<h4>Existing Clusters {{filteredClusters.length}}</h4>
				  <div class="user-list-container">
					  <table class="table table-hover">
						<thead>
						  <tr>
							<th>Zip</th>
							<th>User</th>
							<!-- <th>Care Takers</th> -->
							<th>Delete</th>
						  </tr>
						</thead>
						<tbody>
						  <tr ng-repeat="d in clusters | filter:{ZipCode:careTakerZipFilter} as filteredClusters" data-uid="{{d._id}}">
							<td>
								{{d.ZipCodeCommon}}
							</td>
							<td><a href="mailto:{{d.NeederEmail}}">{{d.NeederEmail}}</a></td>
							<!-- <td>
								{{d.Caretaker1Email}}
							</td> -->
							<!-- Add Custom1 (tags) -->
							<td><button name="remove_cluster" class="btn btn-outline-danger" ng-click="removeCluster(this)">X</button></td>
						  </tr>
						</tbody>
					  </table>
				  </div>
			  </div>
            </div>
          </div>
        </div>
		<div class="container pt-4 pb-2"> <!--CONTAINER DIV FOR FOOTER AND ADDITIONAL INFO-->
		  <div class="row">
			<div class="container d-flex justify-content-center">
				<hr />

			</div>
		  </div>
		</div>
		<div class="container pt-4 pb-2"> <!--CONTAINER DIV FOR FOOTER AND ADDITIONAL INFO-->
		  <div class="row">
			<div class="container d-flex justify-content-center">
			  <footer>
				<p>
				  CoronavirusArmy | <a href="https://www.coronavirusarmy.org">coronavirusarmy.org</a> | 2020
				</p>
			  </footer>
			</div>
		  </div>
		</div>
		<script>
		// var data = [{"_id":"5e779f0b6cbfc12a075f143b","email":"howard@notreal.com","name":"Howard Humphries","ZipCode":"94703","Description":"Deliveries needed","__v":0},{"_id":"5e779f0b6cbfc12a075f143d","email":"betty@notreal.com","name":"Betty Crocker","ZipCode":"10034","Description":"Deliveries needed","__v":0},{"_id":"5e779f0b6cbfc12a075f143e","email":"casey@notreal.com","name":"Casey Casum","ZipCode":"94703","Description":"Babysitting","__v":0}]
		//import {MatSortModule} from '@angular/material/sort';
		// Filter by zip: http://c29a9953.ngrok.io/api/v1/NeedersLookingForMatch?query=%7B%22ZipCode%22:%2294703%22%7D
		var app = angular.module('myApp', []);
		app.controller('myCtrl', function($scope, $http) {
			$scope.useAPI = true;
			$scope.apiHost = 'http://c29a9953.ngrok.io/api/v1/';
			$scope.neederTable = 'NeedersLookingForMatch';
			$scope.careTakerTable = 'CaretakersLookingForMatch';
			$scope.matchedClustersTable = 'MatchedClusters';
			$scope.headerOptions = {};
			$scope.successMessage = '';
			$scope.userReturnCount = 0;
			$scope.showPWRow = true;
			$scope.showInitialSelectionRow = false;
			$scope.showMainConsoleRow = false;
			$scope.clusterCaretakerLimit = 10;

			//$scope.includeClustered = 1;
			$scope.PW;
			$scope.needs = {'Delivery': 'Deliver', 'Babysitting': 'Babysitting', 'Emotional Support': 'Emotional Support', 'Water': 'Water'};
			$scope.needFilter;
			$scope.selectedNeeder;
			$scope.neederZipFilter;
			$scope.neederCount = 0;
			$scope.neederOrderByVar = 'name';
			$scope.careTakerZipFilter;
			$scope.careTakerCount = 0;
			$scope.careTakerOrderByVar = 'name';
			$scope.propertyName = 'name';
			$scope.reverse = true;
			$scope.apiFilters = {};
			$scope.zipApiFilter;
			$scope.hashApiFilter;
			$scope.zipSummary = {};
			$scope.zipButtons = '';

			$scope.needers = [];
			$scope.careTakers = [];
			$scope.clusters = [];

			$scope.init = function(){
				//$scope.fetchUserList();
				$scope.pageAttributes.init();
			}
			
			$scope.zipList = [];
			$scope.zipListMax = 10;
			$scope.zipListSkip = 0;
			$scope.fetchDistinctZips = function(){
				//http://ab86fd25.ngrok.io/api/v1/NeedersLookingForMatch?distinct=ZipCode&limit=10
				q = '?distinct=ZipCode&limit=' + $scope.zipListMax + '&skip=' + $scope.zipListSkip;
				$http.get($scope.apiHost + $scope.neederTable + q, $scope.headerOptions)
				.then(function(response) {
					$scope.zipList = response.data;
					$scope.zipListSkip += $scope.zipListMax; // Increment skip by limit
					// TO DO: Get counts for each zip code
				}, function (response){
					$scope.handleApiError(response)
				});
			}
			$scope.setMainFilters = function(){
				if($scope.zipApiFilter != '')
					$scope.apiFilters.ZipCode = $scope.zipApiFilter;
				if($scope.hashApiFilter != '')
					$scope.apiFilters.Hashtags = $scope.hashApiFilter;
				$scope.fetchUserList();
			}
			$scope.setZip = function(zip){
				$scope.setCareTakerZipFilter(zip);
				$scope.neederZipFilter = zip;
				$scope.neederCount = $scope.needers.filter((needers) => !zip || needers.ZipCode == zip).length;
				// TO DO: If neederCount == 0, fetch needers for this zip
				if($scope.neederCount == 0)
					$scope.fetchUserList();
			}
			$scope.setCareTakerZipFilter = function(zip){
				$scope.careTakerZipFilter = zip;
				$scope.setCareTakerCount();
			}
			$scope.setCareTakerCount = function(){
				zip = $scope.careTakerZipFilter;
				need = $scope.needFilter;
				$scope.careTakerCount = $scope.careTakers.filter(
					(careTakers) => (!zip || careTakers.ZipCode == zip)
					&& (!need || careTakers.Description.match(need) != null)).length;
				// TO DO: If careTakerCount == 0, fetch caretakers for this zip and hash
				
			}
			$scope.setNeedFilter = function(need){
				var filter;
				var reg;
				if(need){
					for(var n in $scope.needs){
						reg = new RegExp($scope.needs[n]);
						if(need.match(reg) != null){
							filter = $scope.needs[n];
							break;
						}
					}
					if(filter)
						need = filter;
				}
				$scope.needFilter = need;
				$scope.setCareTakerCount();
			}
			$scope.neederOrderBy = function(orderBy){
				$scope.neederOrderByVar = orderBy;
			}
			$scope.careTakerOrderBy = function(orderBy){
				$scope.careTakerOrderByVar = orderBy;
			}
			$scope.setNeeder = function(obj){
				$scope.selectedNeeder = obj.d;
				$scope.setCareTakerZipFilter(obj.d.ZipCode);
				$scope.setNeedFilter(obj.d.Description);
			}
			$scope.setUseAPI = function(val){
				$scope.useAPI = val;
				$scope.showPWRow = false;
				if(typeof $scope.pageAttributes.urlKeyVals.z != "undefined" || typeof $scope.pageAttributes.urlKeyVals.h != "undefined"){
					if(typeof $scope.pageAttributes.urlKeyVals.z != "undefined")
						$scope.apiFilters.ZipCode = $scope.pageAttributes.urlKeyVals.z;
					if(typeof $scope.pageAttributes.urlKeyVals.h != "undefined")
						$scope.apiFilters.Hashtags = $scope.pageAttributes.urlKeyVals.h;
					$scope.showMainConsoleRow = true;
					$scope.fetchUserList();
				}
				else
					$scope.showInitialSelectionRow = true;
			}
			$scope.filtersToApiString = function(){
				if(typeof $scope.apiFilters != "object" || Object.keys($scope.apiFilters).length < 1)
					return '';
				// Sample: http://c29a9953.ngrok.io/api/v1/NeedersLookingForMatch/?limit=50&query={"ZipCode":"19871","Hashtags":"MyHash"}
				var ret = '&query={';
				for(var key in $scope.apiFilters){
					if($scope.apiFilters[key])
						if(key == 'Hashtags')
							ret += '"' + key + '":{"$regex":"' + $scope.apiFilters[key] + '"},';
						else
							ret += '"' + key + '":"' + $scope.apiFilters[key] + '",';
				}
				return ret.replace(/,$/, '') + '}';
			}
			$scope.showMainConsole = function(){
				$scope.showMainConsoleRow = true;
				$scope.showInitialSelectionRow = false;
			}
			$scope.setInitialOptions = function(){
				$scope.showInitialSelectionRow = true;
				$scope.fetchUserList();
			}
			$scope.fetchUserList = function(){
				$scope.showMainConsoleRow = true;
				$scope.showInitialSelectionRow = false;
				/*var headerDict = {
					'Authorization': $scope.PW
				};
				$scope.headerOptions = {headers: headerDict};*/

				var q = '?limit=50&sort=ZipCode,Hashtags';
				if(Object.keys($scope.apiFilters).length > 0)
					q += $scope.filtersToApiString();
				console.log(q);
				// " = %22
				// hashApiFilter
				// Fetch needers
				if($scope.useAPI){
					$http.get($scope.apiHost + $scope.neederTable + q, $scope.headerOptions)
					.then(function(response) {
						//console.log(response.data);
						// If $scope.needers.length > 0, append data to local data ensuring it's unique
						if($scope.needers.length == 0)
							$scope.needers = response.data;
						else{
							var idHashTable = {};
							for(var i = 0; i < $scope.needers.length; i++)
								idHashTable[$scope.needers[i]._id] = 1;
							for(var i = 0; i < response.data.length; i++)
								if(!idHashTable[response.data[i]._id])
									$scope.needers.push(response.data[i]);
						}
						$scope.afterUserListFetches();
					}, function (response){
						$scope.handleApiError(response);
						$scope.afterUserListFetches();
					});
					
					// Fetch careTakers
					$http.get($scope.apiHost + $scope.careTakerTable + q, $scope.headerOptions)
					.then(function(response) {
						// If $scope.careTakers.length > 0, append data to local data ensuring it's unique
						if($scope.careTakers.length == 0)
							$scope.careTakers = response.data;
						else{
							var idHashTable = {};
							for(var i = 0; i < $scope.careTakers.length; i++)
								idHashTable[$scope.careTakers[i]._id] = 1;
							for(var i = 0; i < response.data.length; i++)
								if(!idHashTable[response.data[i]._id])
									$scope.careTakers.push(response.data[i]);
						}
						$scope.afterUserListFetches();
					}, function (response){
						$scope.handleApiError(response);
						$scope.afterUserListFetches();
					});
					
					// Fetch clusters
					$http.get($scope.apiHost + $scope.matchedClustersTable + q, $scope.headerOptions)
					.then(function(response) {
						// If $scope.clusters.length > 0, append data to local data ensuring it's unique
						if($scope.clusters.length == 0)
							$scope.clusters = response.data;
						else{
							var idHashTable = {};
							for(var i = 0; i < $scope.clusters.length; i++)
								idHashTable[$scope.clusters[i]._id] = 1;
							for(var i = 0; i < response.data.length; i++)
								if(!idHashTable[response.data[i]._id])
									$scope.clusters.push(response.data[i]);
						}
					}, function (response){
						$scope.handleApiError(response);
					});
				}
				else{
					$scope.needers = $scope.defaultNeeders;
					$scope.careTakers = $scope.defaultCareTakers;
					$scope.clusters = $scope.defaultClusters;
					$scope.afterUserListFetches();
					$scope.afterUserListFetches();
				}
			}
			$scope.afterUserListFetches = function(){
				$scope.userReturnCount++;
				if($scope.userReturnCount == 2){
					$scope.populateZipSummary();
					$scope.userReturnCount = 0;
					$scope.neederCount = $scope.needers.length;
					$scope.careTakerCount = $scope.careTakers.length;
				}
			}
			$scope.populateZipSummary = function(){
				// Get zips & counts from needers & careTakers
				var tmp;
				$scope.zipSummary = {};
				for(var i = 0; i < $scope.needers.length; i++){
					tmp = $scope.needers[i].ZipCode;
					if(tmp != undefined){
						if(typeof $scope.zipSummary[tmp] == "undefined"){
							$scope.zipSummary[tmp] = {needers : 1, careTakers : 0};
						}
						else{
							$scope.zipSummary[tmp].needers++;
						}
					}
				}
				for(var i = 0; i < $scope.careTakers.length; i++){
					tmp = $scope.careTakers[i].ZipCode;
					if(tmp != undefined){
						if(typeof $scope.zipSummary[tmp] == "undefined"){
							$scope.zipSummary[tmp] = {needers : 0, careTakers : 1};
						}
						else{
							$scope.zipSummary[tmp].careTakers++;
						}
					}
				}
			}

			$scope.removeUser = function(user_uid, type){
				// Call service to remove user
				if(type == "needers"){
					if($scope.useAPI){
						$http.delete($scope.apiHost + $scope.neederTable + '/' + user_uid, $scope.headerOptions)
						.then(function(response){
							console.log('Removed user');
							// Remove user from page
							for(var i = 0; i < $scope.needers.length; i++){
								if($scope.needers[i]._id == user_uid){
									$scope.needers.splice(i, 1);
									break;
								}
							}
							//$scope.filteredNeeders = angular.copy($scope.needers);
							$scope.displaySuccess('Successfully removed user');
							$scope.populateZipSummary();
						}, function (response){
							$scope.handleApiError(response);
						});
					}
				}
				else if(type == "careTakers"){
					if($scope.useAPI){
						$http.delete($scope.apiHost + $scope.careTakerTable + '/' + user_uid, $scope.headerOptions)
						.then(function(response){
							//console.log(response);
							// Remove user from page
							for(var i = 0; i < $scope.careTakers.length; i++){
								if($scope.careTakers[i]._id == user_uid){
									$scope.careTakers.splice(i, 1);
									break;
								}
							}
							$scope.displaySuccess('Successfully removed user');
							$scope.populateZipSummary();
						}, function (response){
							$scope.handleApiError(response);
						});
					}
				}
				else
					console.log("type not found");
			}
			$scope.formCluster = function(){
				// Insert the user details into the matched clusters table
				var selectedCareTakers = [];
				for(var i = 0; i < $scope.careTakers.length; i++){
					if($scope.careTakers[i].selected){
						selectedCareTakers.push($scope.careTakers[i]);
					}
				}
				
				// Validate
				var needer = $scope.selectedNeeder;
				if(!needer){
					alert('No needer selected');
					return false;
				}
				else if(selectedCareTakers.length > $scope.clusterCaretakerLimit){
					alert('Care takers cannot exceed ' + $scope.clusterCaretakerLimit);
					return false;
				}

				// If needer already in cluster, add givers to existing cluster
				var tmpJson, clusterI, clusterId;
				for(var i = 0; i < $scope.clusters.length; i++){
					console.log(i);
					if($scope.clusters[i].ExraJSONstrings){
						tmpJson = angular.toJson($scope.clusters[i].ExraJSONstrings);
						console.log(tmpJson);
						if(needer._id == tmpJson[0]._id){
							clusterI = i;
							clusterId = $scope.clusters[i]._id;
							break;
						}
					}
				}
				var nums = [];
				
				if(clusterId){
					// Check if adding these caretakers to existing cluster is viable
					for(var key in $scope.clusters[clusterI]){
						if(key.match(/caretaker\d+/i) != null)
							nums.push(key.match(/\d+/)[0]);
					}
					if(nums.length + selectedCareTakers.length > $scope.clusterCaretakerLimit)
						clusterId = null;
				}
				
				if(clusterId){
					// Update existing cluster
					var careTakerIndex = 0;
					var data = {};
					// Add caretaker emails to data object
					for(var i = 1; i < $scope.clusterCaretakerLimit + 1; i++){
						if(nums.indexOf(i) == -1){
							data['Caretaker' + i + 'Email'] = selectedCareTakers[careTakerIndex].email;
							careTakerIndex++;
						}
					}
					// Update the cluster
					$http.put($scope.apiHost + $scope.matchedClustersTable + '/' + clusterId, data, $scope.headerOptions)
					.then(function(response){
						// Adding back to the page
						// TO DO: Update existing cluster on page
						//$scope.clusters.push(response.data);
						//console.log("formCluster returned");
					}, function(response){
						$scope.handleApiError(response);
					});
				}
				else{
					// Create new cluster
					// Prepare data
					var data = {
						NeederEmail : needer.email,
						ZipCodeCommon : needer.ZipCode,
						ClusterIsActive : true,
						HashtagsCommon : needer.Hashtags
					};
					var extraJsonObj = [], extraJsonStr;
					extraJsonObj.push(needer);

					for(var i = 0; i < selectedCareTakers.length; i++){
						var propName = 'Caretaker' + i+1 + 'Email';
						data[propName] = selectedCareTakers[i].email;
						extraJsonObj.push(selectedCareTakers[i]);
					}
					extraJsonStr = angular.toJson(extraJsonObj);

					data.ExtraJSONstrings = extraJsonStr;

					//console.log(JSON.stringify(data));
					if($scope.useAPI){
						// Post data to cluster table
						$http.post($scope.apiHost + $scope.matchedClustersTable, data, $scope.headerOptions)
						.then(function(response){
							// Adding back to the page
							// TO DO: Validate the returned data
							$scope.clusters.push(response.data);
							//console.log("formCluster returned");
						}, function(response){
							$scope.handleApiError(response);
						});
					}
				}

				// Either remove user from source list or decrement RequestedClusterSize/SlotCount
				// Needers
				if(selectedCareTakers.length >= (needer.RequestedClusterSize || 1))
					$scope.removeUser(needer._id, 'needers');
				else{
					needer.RequestedClusterSize -= selectedCareTakers.length;
					// Update needers table
					$http.put($scope.apiHost + $scope.neederTable + '/' + needer._id, {RequestedClusterSize : needer.RequestedClusterSize}, $scope.headerOptions)
					.then(function(response){
						console.log("updated needer");
					}, function(response){
						$scope.handleApiError(response);
					});
				}
				// Caretakers
				for(var i = 0; i < selectedCareTakers.length; i++){
					if(1 >= (selectedCareTakers.SlotCount || 1))
						$scope.removeUser(selectedCareTakers[i]._id, 'careTakers');
					else{
						selectedCareTakers.SlotCount--;
						// Update careTakers table
						$http.put($scope.apiHost + $scope.careTakerTable + '/' + selectedCareTakers[i]._id, {SlotCount : selectedCareTakers[i].SlotCount}, $scope.headerOptions)
						.then(function(response){
							console.log("updated careTakers");
						}, function(response){
							$scope.handleApiError(response);
						});
					}
				}
			}
			$scope.removeCluster = function(obj){

				console.log(obj.d.ExtraJSONstrings);
				//return;

				var clusterData = null;

				// Add needers and caretakers back to original tables through API call so they can be clustered again
				// Also add them directly to the page
				if(obj.d.ExtraJSONstrings){
					clusterData = JSON.parse(obj.d.ExtraJSONstrings);
					var found = false;
					var tmp_id, tmpRequestedClusterSize, tmpSlotCount;
					for(var i = 0; i < clusterData.length; i++){
						fount = false;
						if(i == 0){
							// Needer
							// Check if needer already exists, if so, update
							for(var j = 0; j < $scope.needers.length; j++){
								if(clusterData[i]._id == $scope.needers[j]._id){
									found = true;
									if($scope.needers[j].RequestedClusterSize)
										$scope.needers[j].RequestedClusterSize += clusterData.length - 1;
									else
										$scope.needers[j].RequestedClusterSize = clusterData.length - 1;
									tmp_id = $scope.needers[j]._id;
									tmpRequestedClusterSize = $scope.needers[j].RequestedClusterSize;
									break;
								}
							}

							if(!found){
								// Needer does not already exist, add
								clusterData[i].RequestedClusterSize = clusterData.length - 1;
								if($scope.useAPI){
									$http.post($scope.apiHost + $scope.neederTable, clusterData[i], $scope.headerOptions)
									.then(function(response){
										// Adding back to the page
										// TO DO: Validate the data
										$scope.needers.push(response.data);
										$scope.populateZipSummary();
										//$scope.filteredNeeders = angular.copy($scope.needers);
										//console.log("formCluster returned");
									}, function(response){
										$scope.handleApiError(response);
									});
								}
							}
							else{
								// Update needer via API
								if($scope.useAPI){
									$http.put($scope.apiHost + $scope.neederTable + '/' + tmp_id, {RequestedClusterSize : tmpRequestedClusterSize}, $scope.headerOptions)
									.then(function(response){
										;
									}, function(response){
										$scope.handleApiError(response);
									});
								}
							}
						}
						else{
							// Care takers
							// Check if careTaker already exists, if so, update
							tmp_id = '';
							tmpSlotCount = 0;
							for(var j = 0; j < $scope.careTakers.length; j++){
								if(clusterData[i]._id == $scope.careTakers[j]._id){
									found = true;
									if($scope.careTakers[j].SlotCount)
										$scope.careTakers[j].SlotCount++;
									else{
										$scope.careTakers[j].SlotCount = 1;
									}
									tmp_id = $scope.needers[j]._id;
									tmpSlotCount = $scope.careTakers[j].SlotCount;
									break;
								}
							}

							if(!found){
								// careTaker does not already exist, add
								if(!clusterData[i].SlotCount)
									clusterData[i].SlotCount = 1;
								else
									clusterData[i].SlotCount++;
								if($scope.useAPI){
									$http.post($scope.apiHost + $scope.careTakerTable, clusterData[i], $scope.headerOptions)
									.then(function(response){
										// Adding back to the page
										// TO DO: Validate the data
										$scope.careTakers.push(response.data);
										$scope.populateZipSummary();
										//console.log("formCluster returned");
									}, function(response){
										$scope.handleApiError(response);
									});
								}
							}
							else{
								// Update caretaker via API
								if($scope.useAPI){
									$http.put($scope.apiHost + $scope.careTakerTable + '/' + tmp_id, {SlotCount : tmpSlotCount}, $scope.headerOptions)
									.then(function(response){
										;
									}, function(response){
										$scope.handleApiError(response);
									});
								}
							}
						}
					}
				}

				// Mark this cluster inactive
				if($scope.useAPI){
					//$http.delete($scope.apiHost + $scope.matchedClustersTable + '/' + obj.d._id, $scope.headerOptions)
					$http.put($scope.apiHost + $scope.matchedClustersTable + '/' + obj.d._id, {ClusterIsActive : false}, $scope.headerOptions)
					.then(function(response){
						//console.log(response);
						// Remove cluster from page
						for(var i = 0; i < $scope.clusters.length; i++){
							if($scope.clusters[i]._id == obj.d._id){
								$scope.clusters.splice(i, 1);
								break;
							}
						}
						$scope.displaySuccess('Successfully removed cluster');
					}, function (response){
						$scope.handleApiError(response);
					});
				}
			}

			// Helper functions (Not core logic)
			$scope.displayFailure = function(message){
				alert(message);
			}
			$scope.handleApiError = function(response){
				//console.log(response);
				$scope.displayFailure(response.statusText || "There was an error with your request");
			}
			$scope.displaySuccess = function(message){
				$scope.successMessage = message;
				setTimeout( function() {
					$scope.successMessage = '';
				}, 2000);
			}

			$scope.pageAttributes = {
				pathArray : window.location.href.split('/'),
				endOfUrl : null,
				UrlQueryString : null,
				currentPage : null,
				urlKeyVals : {},
				init : function(){
					this.setVals();
				},
				setVals : function(){
					this.endOfUrl = this.pathArray[this.pathArray.length-1];
					this.UrlQueryString = this.getQueryString();
					this.currentPage = this.getPage();
					this.setUrlKeyVals();
				},
				getQueryString : function(){
					var path = window.location.href;
					return path.split('?')[1];
				},
				getPage : function(){
					var path = window.location.href;
					var arr = path.split('/');
					var endOfUrl = arr[arr.length-1];
					return currentPage = endOfUrl.split('.')[0];
				},
				setUrlKeyVals : function(){
					if(this.UrlQueryString !== undefined){
						if(this.UrlQueryString.indexOf('=') === -1)
							return null;
						var getVarArray = this.UrlQueryString.split('&');
						this.urlKeyVals = {};
						var tmpArr;
						for(var i = 0; i < getVarArray.length; i++){
							tmpArr = null;
							tmpArr = getVarArray[i].split('=');
							this.urlKeyVals[tmpArr[0]] = tmpArr[1];
						}
					}
				}
			};

			$scope.defaultNeeders = [{"_id":"5e7f5bf43e3bd26340c59b36","email":"additInfo@notreal.com","name":"TestUpdate","ZipCode":"94703","Description":"SLEEP","AdditioanlInfo":"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. \n Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. \n Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","updated":"2020-03-28T14:15:16.717Z","__v":0},{"_id":"5e7f5c1068f96363885bdd47","email":"additInfo@notreal.com","name":"TestUpdate","ZipCode":"94703","Description":"SLEEP","AdditionalInfo":"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. \n Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. \n Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","updated":"2020-03-28T14:15:44.537Z","__v":0},{"_id":"5e7f6a7e68f96363885bdd49","name":"Huh?","email":"What@huh","ZipCode":"12345","Description":"Babysitting Home Help","Hashtags":"Catholic LGBTQ ","updated":"2020-03-28T15:17:18.283Z","__v":0},{"_id":"5e7f6b4568f96363885bdd4b","name":"ghjkghjk","email":"asdf@dklnm","ZipCode":"11111","Description":"Emotional Support Remote Help","Hashtags":"","updated":"2020-03-28T15:20:37.116Z","__v":0},{"_id":"5e7f6d2c68f96363885bdd4e","name":"yuioyu","email":"uio@uio","ZipCode":"11111","Description":"General Deliveries","Hashtags":"","updated":"2020-03-28T15:28:44.226Z","__v":0},{"_id":"5e7f8b0468f96363885bdd52","name":"sdfgg","email":"dfhgdf@vbnv","ZipCode":"11111","Description":"Emotional Support Remote Help","Hashtags":"","updated":"2020-03-28T17:36:04.302Z","__v":0},{"_id":"5e7f8b2f68f96363885bdd53","name":"Albert Turing","email":"at2@vbnv","ZipCode":"11111","Description":"Emotional Support Remote Help","Hashtags":"","updated":"2020-03-28T17:36:47.960Z","__v":0},{"_id":"5e7f8b4868f96363885bdd54","name":"Albert Franklin","email":"af2@vbnv","ZipCode":"11111","Description":"Emotional Support Remote Help","Hashtags":"","updated":"2020-03-28T17:37:12.177Z","__v":0},{"_id":"5e7f8b5e68f96363885bdd55","name":"Albert Washington","email":"as2@vbnv","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","updated":"2020-03-28T17:37:34.200Z","__v":0},{"_id":"5e7f8b8c68f96363885bdd56","name":"Alan Einstein","email":"ae2@vbnv","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","updated":"2020-03-28T17:38:20.821Z","__v":0},{"_id":"5e7f9e7d77fbd465e065e7e4","name":"Sam I am","email":"sia@gmail.com","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","RequestedClusterSize":3,"updated":"2020-03-28T18:59:09.157Z","__v":0},{"_id":"645532205501181000000000","email":"email@gmail.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.196Z","__v":0},{"_id":"485736874665340000000000","email":"email@yahoo.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.193Z","__v":0},{"_id":"187177955514700000000000","email":"email@hotmail.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.196Z","__v":0},{"_id":"483299857861642000000000","email":"email@corona.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.196Z","__v":0},{"_id":"856800520507356000000000","email":"sjobs@apple.com","name":"Sjobs","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.197Z","__v":0},{"_id":"130074171404231000000000","email":"email@3hands.org","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.197Z","__v":0},{"_id":"924416901250420000000000","email":"billyG@microsoft.com","name":"BigBillyG","ZipCode":"19871","Description":"Needer","Hashtags":"BayAreaHospitalAssociation","updated":"2020-03-28T22:42:24.197Z","__v":0},{"_id":"5e7fd4fd77fbd465e065e7ef","name":"Taylor Johnson","email":"TJ2@gmail.com","ZipCode":"11111","Description":"Food Deliveries","Hashtags":"","RequestedClusterSize":10,"updated":"2020-03-28T22:51:41.584Z","__v":0},{"_id":"5e7fd61177fbd465e065e7f1","name":"Jer Tay","email":"jt3@gmail.com","ZipCode":"11111","Description":"General Remote Help","Hashtags":"","RequestedClusterSize":10,"updated":"2020-03-28T22:56:17.143Z","__v":0},{"_id":"834500792974434000000000","email":"email@yahoo.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.828Z","__v":0},{"_id":"279811452249125000000000","email":"email@gmail.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.830Z","__v":0},{"_id":"314913312918742000000000","email":"email@hotmail.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.831Z","__v":0},{"_id":"390174034742152000000000","email":"email@3hands.org","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.831Z","__v":0},{"_id":"615994786605913000000000","email":"email@corona.com","name":"Rand","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.831Z","__v":0},{"_id":"726041058139038000000000","email":"billyG@microsoft.com","name":"BigBillyG","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.832Z","__v":0},{"_id":"534977939341773000000000","email":"sjobs@apple.com","name":"Sjobs","ZipCode":"19871","Description":"Needer","Hashtags":"HochosCoronaArmy","updated":"2020-03-29T00:31:39.832Z","__v":0},{"_id":"815000000000000000000000","email":"email@yahoo.com","name":"Rand","ZipCode":"19871","Description":"Needer","updated":"2020-03-29T03:27:26.222Z","__v":0},{"_id":"5e792bc46cbfc12a075f1443","email":"anelliealex@oulu.com","name":"Alex Kirk","ZipCode":"35005","Description":"Babysitting","updated":"2020-03-29T16:59:33.190Z","__v":0},{"_id":"5e792be46cbfc12a075f1452","email":"dionnemassey@medalert.com","name":"Montgomery Navarro","ZipCode":"35005","Description":"Food delivery","updated":"2020-03-29T19:48:17.080Z","__v":0},{"_id":"5e792be46cbfc12a075f144e","email":"shieldspatel@medalert.com","name":"Linda Haney","ZipCode":"35005","Description":"Medicine delivery","RequestedClusterSize":2,"updated":"2020-03-29T20:36:19.111Z","__v":0}];
			$scope.defaultCareTakers = [{"_id":"5e779f0b6cbfc12a075f143f","email":"zoe@notreal.com","name":"Zoe Zappo","ZipCode":"94703","Description":"Offering Deliveries","__v":0},{"_id":"5e779f0b6cbfc12a075f1442","email":"xavier@notreal.com","name":"Xavier Dr.Xmen","ZipCode":"94703","Description":"Offering Deliveries","__v":0},{"_id":"5e792c006cbfc12a075f14b8","email":"altatran@medalert.com","name":"Jarvis Pena","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14bb","email":"frostolson@medalert.com","name":"Blanca William","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14c3","email":"parsonsstuart@medalert.com","name":"Alma Chase","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14bc","email":"blancawilliam@medalert.com","name":"Tricia Waters","ZipCode":"1001","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14c8","email":"ricemacdonald@medalert.com","name":"Ann Kirby","ZipCode":"35005","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14c0","email":"cookcraft@medalert.com","name":"Angelina Chandler","ZipCode":"1001","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14c2","email":"hildarusso@medalert.com","name":"Parsons Stuart","ZipCode":"90201","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14a8","email":"carverlott@medalert.com","name":"Imogene Carey","ZipCode":"1001","Description":"Deliveries needed","updated":"2020-03-29T16:58:51.306Z","__v":0},{"_id":"5e792c006cbfc12a075f14a9","email":"imogenecarey@medalert.com","name":"Myrtle Moss","ZipCode":"1001","Description":"Water needed","updated":"2020-03-29T16:59:16.292Z","__v":0},{"_id":"5e792c006cbfc12a075f14c6","email":"thompsongay@medalert.com","name":"Gray Petersen","ZipCode":"1001","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14ca","email":"kayesimpson@medalert.com","name":"Bell Perez","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14cc","email":"josefinavasquez@medalert.com","name":"Erna Mcdowell","ZipCode":"1001","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14d2","email":"skinnersantana@medalert.com","name":"Brenda Travis","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14d0","email":"judyhewitt@medalert.com","name":"Consuelo Mcmahon","ZipCode":"35005","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14d3","email":"brendatravis@medalert.com","name":"Jacquelyn Simmons","ZipCode":"1001","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14d1","email":"consuelomcmahon@medalert.com","name":"Skinner Santana","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14d4","email":"jacquelynsimmons@medalert.com","name":"Brooke Klein","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14d5","email":"brookeklein@medalert.com","name":"Chavez Duke","ZipCode":"1001","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14d6","email":"chavezduke@medalert.com","name":"Dunlap Mcclain","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14d9","email":"whiteharding@medalert.com","name":"Rosie Fitzgerald","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14e1","email":"shaunafrazier@medalert.com","name":"Boyd Warren","ZipCode":"1001","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14dd","email":"marvafitzpatrick@medalert.com","name":"Love Coleman","ZipCode":"90201","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14e0","email":"guzmanpowers@medalert.com","name":"Shauna Frazier","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14da","email":"rosiefitzgerald@medalert.com","name":"Ashlee Garrett","ZipCode":"90201","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14de","email":"lovecoleman@medalert.com","name":"Strickland Cantu","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14e6","email":"casehull@medalert.com","name":"Clemons Sims","ZipCode":"1001","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14e2","email":"boydwarren@medalert.com","name":"Genevieve Lara","ZipCode":"1001","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14e5","email":"valdezmitchell@medalert.com","name":"Case Hull","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14df","email":"stricklandcantu@medalert.com","name":"Guzman Powers","ZipCode":"1001","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14e3","email":"genevievelara@medalert.com","name":"Harriet Walker","ZipCode":"35005","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14e7","email":"clemonssims@medalert.com","name":"Joanne Estes","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14e4","email":"harrietwalker@medalert.com","name":"Valdez Mitchell","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14ea","email":"craigsantos@medalert.com","name":"Gentry Dominguez","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14e8","email":"joanneestes@medalert.com","name":"Latisha Copeland","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14ec","email":"dyermayo@medalert.com","name":"Hancock Graham","ZipCode":"35005","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14ed","email":"hancockgraham@medalert.com","name":"Carter Haley","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14ee","email":"carterhaley@medalert.com","name":"Wise Mooney","ZipCode":"35005","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14ef","email":"wisemooney@medalert.com","name":"Inez Jefferson","ZipCode":"1001","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14f2","email":"nguyensuarez@medalert.com","name":"Dana Wright","ZipCode":"1001","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14f5","email":"foxmcfadden@medalert.com","name":"Shannon Mclean","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14f7","email":"averymcguire@medalert.com","name":"Maura Hudson","ZipCode":"1001","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f14fa","email":"marcynash@medalert.com","name":"Enid Ingram","ZipCode":"90201","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14f4","email":"marcellamcknight@medalert.com","name":"Fox Mcfadden","ZipCode":"35005","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f14fc","email":"toddhicks@medalert.com","name":"Bridges Booth","ZipCode":"1001","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14f8","email":"maurahudson@medalert.com","name":"Gena Warner","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f1501","email":"annalarsen@medalert.com","name":"Christy Herrera","ZipCode":"1001","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14fe","email":"angelitaford@medalert.com","name":"Stout Rivas","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f1503","email":"maricelaedwards@medalert.com","name":"Clarke Ray","ZipCode":"1001","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f14ff","email":"stoutrivas@medalert.com","name":"Gladys Lopez","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14fd","email":"bridgesbooth@medalert.com","name":"Angelita Ford","ZipCode":"35005","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f1506","email":"janariggs@medalert.com","name":"Snow Vinson","ZipCode":"90201","Description":"Deliveries needed","__v":0},{"_id":"5e792c006cbfc12a075f1508","email":"estelaortega@medalert.com","name":"Abbott House","ZipCode":"35005","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f1504","email":"clarkeray@medalert.com","name":"Larsen Navarro","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f1502","email":"christyherrera@medalert.com","name":"Maricela Edwards","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f150b","email":"earlenestone@medalert.com","name":"Estrada Cross","ZipCode":"35005","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f1509","email":"abbotthouse@medalert.com","name":"Jillian Parrish","ZipCode":"90201","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f1507","email":"snowvinson@medalert.com","name":"Estela Ortega","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e792c006cbfc12a075f14f1","email":"katelyndurham@medalert.com","name":"Nguyen Suarez","ZipCode":"1001","Description":"Babysitting","__v":0},{"_id":"5e792c006cbfc12a075f14f6","email":"shannonmclean@medalert.com","name":"Avery Mcguire","ZipCode":"1001","Description":"Food delivery","__v":0},{"_id":"5e792c006cbfc12a075f1500","email":"gladyslopez@medalert.com","name":"Anna Larsen","ZipCode":"35005","Description":"Water needed","__v":0},{"_id":"5e792c006cbfc12a075f150a","email":"jillianparrish@medalert.com","name":"Earlene Stone","ZipCode":"90201","Description":"Medicine delivery","__v":0},{"_id":"5e7f6c2f68f96363885bdd4c","name":"ghk","email":"ghk@oiuert","ZipCode":"11111","Description":"General Home Help","Hashtags":"","updated":"2020-03-28T15:24:31.132Z","__v":0},{"_id":"5e7f6cf768f96363885bdd4d","name":"rtyurty","email":"rtyu@yuio","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","updated":"2020-03-28T15:27:51.677Z","__v":0},{"_id":"5e7f750d68f96363885bdd4f","name":"sdfgdf","email":"dfghdfh@uio","ZipCode":"11111","Description":"Food Deliveries","Hashtags":"LGBTQ ","updated":"2020-03-28T16:02:21.114Z","__v":0},{"_id":"5e7f7eb968f96363885bdd51","name":"bnb","email":"vbnv@vbnv","ZipCode":"11111","Description":"General Deliveries","Hashtags":"","updated":"2020-03-28T16:43:37.371Z","__v":0},{"_id":"5e7f9ebb77fbd465e065e7e5","name":"Sam I am not","email":"sian@gmail.com","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","SlotCount":6,"updated":"2020-03-28T19:00:11.051Z","__v":0},{"_id":"5e7fa37977fbd465e065e7e6","name":"Benjamin Payne","email":"bp@gmail.com","ZipCode":"11111","Description":"Water Deliveries","Hashtags":"","SlotCount":6,"updated":"2020-03-28T19:20:25.682Z","__v":0},{"_id":"5e7fd50f77fbd465e065e7f0","name":"Jack Swift","email":"JS2@gmail.com","ZipCode":"11111","Description":"Food Deliveries","Hashtags":"","SlotCount":10,"updated":"2020-03-28T22:51:59.566Z","__v":0},{"_id":"845000000000000000000000","email":"email@yahoo.com","name":"Rand","ZipCode":"19871","Description":"Needer","updated":"2020-03-29T03:27:26.252Z","__v":0},{"_id":"5e792c006cbfc12a075f14ac","email":"donavalentine@medalert.com","name":"Stacie Talley","ZipCode":"1001","Description":"Food delivery","updated":"2020-03-29T16:58:51.266Z","__v":0},{"_id":"5e792c006cbfc12a075f14af","email":"foremanpadilla@medalert.com","name":"Cynthia Frank","ZipCode":"1001","Description":"Water needed","updated":"2020-03-29T16:59:16.294Z","__v":0},{"_id":"5e792c006cbfc12a075f14b3","email":"teridotson@medalert.com","name":"Lauri Mcleod","ZipCode":"35005","Description":"Food delivery","updated":"2020-03-29T16:59:33.200Z","__v":0},{"_id":"5e792c006cbfc12a075f14e9","email":"latishacopeland@medalert.com","name":"Craig Santos","ZipCode":"35005","Description":"Food delivery","updated":"2020-03-29T19:48:17.108Z","__v":0},{"_id":"5e792c006cbfc12a075f14f0","email":"inezjefferson@medalert.com","name":"Katelyn Durham","ZipCode":"35005","Description":"Food delivery","updated":"2020-03-29T19:48:17.125Z","__v":0},{"_id":"5e792c006cbfc12a075f14f3","email":"danawright@medalert.com","name":"Marcella Mcknight","ZipCode":"35005","Description":"Medicine delivery","SlotCount":1,"updated":"2020-03-29T20:36:19.189Z","__v":0},{"_id":"5e792c006cbfc12a075f14c9","email":"annkirby@medalert.com","name":"Kaye Simpson","ZipCode":"35005","Description":"Deliveries needed","SlotCount":1,"updated":"2020-03-29T20:36:19.394Z","__v":0}];
			$scope.defaultClusters = [{"_id":"5e7c06136cbfc12a075f1514","NeederEmail":"harriscampos@medalert.com","ZipCodeCommon":"1001","Caretaker1Email":"carverlott@medalert.com","Caretaker2Email":"imogenecarey@medalert.com","Caretaker3Email":"foremanpadilla@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1444\",\"email\":\"harriscampos@medalert.com\",\"name\":\"Estella Richmond\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14a8\",\"email\":\"carverlott@medalert.com\",\"name\":\"Imogene Carey\",\"ZipCode\":\"1001\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14a9\",\"email\":\"imogenecarey@medalert.com\",\"name\":\"Myrtle Moss\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14af\",\"email\":\"foremanpadilla@medalert.com\",\"name\":\"Cynthia Frank\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c0d396cbfc12a075f1517","NeederEmail":"sanfordfuentes@medalert.com","ZipCodeCommon":"35005","Caretaker1Email":"claytonchang@medalert.com","Caretaker2Email":"cynthiafrank@medalert.com","Caretaker3Email":"grimesbuck@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1447\",\"email\":\"sanfordfuentes@medalert.com\",\"name\":\"Carter Banks\",\"ZipCode\":\"35005\",\"Description\":\"Babysitting\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14ab\",\"email\":\"claytonchang@medalert.com\",\"name\":\"Dona Valentine\",\"ZipCode\":\"35005\",\"Description\":\"Food delivery\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b0\",\"email\":\"cynthiafrank@medalert.com\",\"name\":\"Hazel Meyers\",\"ZipCode\":\"35005\",\"Description\":\"Medicine delivery\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b7\",\"email\":\"grimesbuck@medalert.com\",\"name\":\"Alta Tran\",\"ZipCode\":\"35005\",\"Description\":\"Medicine delivery\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c122146334e510805e495","NeederEmail":"betty@notreal.com","ZipCodeCommon":"10034","ExtraJSONstrings":"[{\"_id\":\"5e779f0b6cbfc12a075f143d\",\"email\":\"betty@notreal.com\",\"name\":\"Betty Crocker\",\"ZipCode\":\"10034\",\"Description\":\"Deliveries needed\",\"__v\":0}]","__v":0},{"_id":"5e80e613e08e5a6c057a0b26","NeederEmail":"harriscampos@medalert.com","ZipCodeCommon":"1001","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1444\",\"email\":\"harriscampos@medalert.com\",\"name\":\"Estella Richmond\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"updated\":\"2020-03-29T16:58:51.309Z\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14fb\",\"email\":\"enidingram@medalert.com\",\"name\":\"Todd Hicks\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true}]","updated":"2020-03-29T18:16:51.658Z","__v":0},{"_id":"5e7c0f8146334e510805e494","NeederEmail":"taylorcampos@medalert.com","ZipCodeCommon":"1001","Caretaker1Email":"donavalentine@medalert.com","Caretaker2Email":"gaylelott@medalert.com","Caretaker3Email":"laurimcleod@medalert.com","Caretaker4Email":"mccartyjohns@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1446\",\"email\":\"taylorcampos@medalert.com\",\"name\":\"Sanford Fuentes\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14ac\",\"email\":\"donavalentine@medalert.com\",\"name\":\"Stacie Talley\",\"ZipCode\":\"1001\",\"Description\":\"Food delivery\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14ae\",\"email\":\"gaylelott@medalert.com\",\"name\":\"Foreman Padilla\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b4\",\"email\":\"laurimcleod@medalert.com\",\"name\":\"Mccarty Johns\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b5\",\"email\":\"mccartyjohns@medalert.com\",\"name\":\"Solomon Brady\",\"ZipCode\":\"1001\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c123f46334e510805e496","NeederEmail":"estellarichmond@medalert.com","ZipCodeCommon":"90201","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1445\",\"email\":\"estellarichmond@medalert.com\",\"name\":\"Taylor Campos\",\"ZipCode\":\"90201\",\"Description\":\"Babysitting\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14aa\",\"email\":\"myrtlemoss@medalert.com\",\"name\":\"Clayton Chang\",\"ZipCode\":\"90201\",\"Description\":\"Babysitting\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14ad\",\"email\":\"stacietalley@medalert.com\",\"name\":\"Gayle Lott\",\"ZipCode\":\"90201\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b1\",\"email\":\"hazelmeyers@medalert.com\",\"name\":\"Merrill King\",\"ZipCode\":\"90201\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b2\",\"email\":\"merrillking@medalert.com\",\"name\":\"Teri Dotson\",\"ZipCode\":\"90201\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b9\",\"email\":\"jarvispena@medalert.com\",\"name\":\"Olga Sweet\",\"ZipCode\":\"90201\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14b6\",\"email\":\"solomonbrady@medalert.com\",\"name\":\"Grimes Buck\",\"ZipCode\":\"90201\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c130946334e510805e497","NeederEmail":"taylorcampos@medalert.com","ZipCodeCommon":"1001","Caretaker1Email":"laurimcleod@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1446\",\"email\":\"taylorcampos@medalert.com\",\"name\":\"Sanford Fuentes\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14b4\",\"email\":\"laurimcleod@medalert.com\",\"name\":\"Mccarty Johns\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},\"\",\"\"]","__v":0},{"_id":"5e7c131346334e510805e498","NeederEmail":"carterbanks@medalert.com","ZipCodeCommon":"35005","Caretaker1Email":"laurimcleod@medalert.com","Caretaker2Email":"triciawaters@medalert.com","Caretaker3Email":"lindarowe@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1448\",\"email\":\"carterbanks@medalert.com\",\"name\":\"Valarie Galloway\",\"ZipCode\":\"35005\",\"Description\":\"Babysitting\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14b4\",\"email\":\"laurimcleod@medalert.com\",\"name\":\"Mccarty Johns\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14bd\",\"email\":\"triciawaters@medalert.com\",\"name\":\"Michael Williamson\",\"ZipCode\":\"35005\",\"Description\":\"Babysitting\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14bf\",\"email\":\"lindarowe@medalert.com\",\"name\":\"Cook Craft\",\"ZipCode\":\"35005\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c131c46334e510805e499","NeederEmail":"taylorcampos@medalert.com","ZipCodeCommon":"1001","Caretaker1Email":"laurimcleod@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1446\",\"email\":\"taylorcampos@medalert.com\",\"name\":\"Sanford Fuentes\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14b4\",\"email\":\"laurimcleod@medalert.com\",\"name\":\"Mccarty Johns\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true},\"\",\"\"]","__v":0},{"_id":"5e7c139b46334e510805e49a","NeederEmail":"lindahaney@medalert.com","ZipCodeCommon":"1001","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f144f\",\"email\":\"lindahaney@medalert.com\",\"name\":\"Marquez Jordan\",\"ZipCode\":\"1001\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14d7\",\"email\":\"dunlapmcclain@medalert.com\",\"name\":\"Gomez Fields\",\"ZipCode\":\"1001\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7c1f9a46334e510805e49d","NeederEmail":"shieldspatel@medalert.com","ZipCodeCommon":"35005","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f144e\",\"email\":\"shieldspatel@medalert.com\",\"name\":\"Linda Haney\",\"ZipCode\":\"35005\",\"Description\":\"Medicine delivery\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14c9\",\"email\":\"annkirby@medalert.com\",\"name\":\"Kaye Simpson\",\"ZipCode\":\"35005\",\"Description\":\"Deliveries needed\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14f3\",\"email\":\"danawright@medalert.com\",\"name\":\"Marcella Mcknight\",\"ZipCode\":\"35005\",\"Description\":\"Medicine delivery\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7dc737ad0f605461db5cb7","NeederEmail":"lulaadams@medalert.com","ZipCodeCommon":"90201","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f144b\",\"email\":\"lulaadams@medalert.com\",\"name\":\"Lillian Lucas\",\"ZipCode\":\"90201\",\"Description\":\"Water needed\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14ba\",\"email\":\"olgasweet@medalert.com\",\"name\":\"Frost Olson\",\"ZipCode\":\"90201\",\"Description\":\"Medicine delivery\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14c1\",\"email\":\"angelinachandler@medalert.com\",\"name\":\"Hilda Russo\",\"ZipCode\":\"90201\",\"Description\":\"Water needed\",\"__v\":0,\"selected\":true}]","__v":0},{"_id":"5e7dd656ad0f605461db5cb8","NeederEmail":"millicentmoreno@medalert.com","ZipCodeCommon":"1001","Caretaker1Email":"lethahendrix@medalert.com","Caretaker2Email":"bellperez@medalert.com","ExtraJSONstrings":"[{\"_id\":\"5e792be46cbfc12a075f1459\",\"email\":\"millicentmoreno@medalert.com\",\"name\":\"Logan Mason\",\"ZipCode\":\"1001\",\"Description\":\"Babysitting\",\"__v\":0},{\"_id\":\"5e792c006cbfc12a075f14ce\",\"email\":\"lethahendrix@medalert.com\",\"name\":\"Nicholson Franks\",\"ZipCode\":\"1001\",\"Description\":\"Babysitting\",\"__v\":0,\"selected\":true},{\"_id\":\"5e792c006cbfc12a075f14cb\",\"email\":\"bellperez@medalert.com\",\"name\":\"Josefina Vasquez\",\"ZipCode\":\"1001\",\"Description\":\"Babysitting\",\"__v\":0,\"selected\":true}]","__v":0}];

			$scope.init();

		});

		</script>

    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-firestore.js"></script>

    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyAEt0G2RgjjMp2MO3NfSwugwkPR9CU3PuI",
        authDomain: "caregivers-57d5f.firebaseapp.com",
        databaseURL: "https://caregivers-57d5f.firebaseio.com",
        projectId: "caregivers-57d5f",
        storageBucket: "caregivers-57d5f.appspot.com",
        messagingSenderId: "884255043543",
        appId: "1:884255043543:web:9878fc0370fff195b8a592",
        measurementId: "G-R75MQ7PRPV"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      //Handle auth events
      firebase.auth().onAuthStateChanged(function(firebaseuser) {
        window.firebaseuser = firebaseuser;
        if(firebaseuser) {
          console.log("WE HAVE A USER");
          console.log(firebaseuser);
		  document.getElementById('login_wrapper').className = 'active';
        } else {
          console.log("not logged in, no firebase user");
        }
      });
    </script>
    </body>
</html>
<!--THIS IS A SIMPLE FILTER LIST (WILL CONNECT TO DATABASE OF MEMBERS) AND HOW IT IS DISPLAYED.
NO NAV/LINK FUNCTIONALITY AT THE MOMENT-->
